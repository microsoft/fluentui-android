jobs:
  - job: Localize
    pool:
      vmImage: ubuntu-latest

    steps:
    - task: Bash@3
      displayName: Localize
      env:
        TDBUILD_TEAM_ID: $(TDBUILD_TEAM_ID)
        TDBUILD_AAD_APPLICATION_CLIENT_ID: $(TDBUILD_AAD_APPLICATION_CLIENT_ID)
        TDBUILD_AAD_APPLICATION_CLIENT_SECRET: $(TDBUILD_AAD_APPLICATION_CLIENT_SECRET)
      inputs:
        targetType: 'inline'
        script: |
            touch test.txt
      
    - task: Bash@3
      displayName: Create PR
      inputs:
        targetType: 'inline'
        script: |
            set -e
            echo "Start."
            # Configure git and Push updates
            git config --global user.email pyeruva@microsoft.com
            git config --global user.name PraveenKumar Yeruva
            git config pull.rebase false
            branch=testLocalize-$(date +%s)
            git branch
            echo "Creating branch $branch"
            git branch $branch
            echo "Checkout $branch"
            git checkout $branch
            # Add / update and commit
            git status
            echo "adding files"
            git add .
            git status | grep modified
            if [ $? -eq 0 ]; then
                echo "Adding git commit"
                git commit -m 'Test Localization [skip ci]'
                echo "Pushing to origin"
                git push origin $branch
                echo "Creating PR"
                gh pr create --title "Test PR" --body "Updated Test strings"
            else
                echo "No changes since last run"
            fi